<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AMERICAN FOOTBALL FUN ‚Äî Transfers</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* ===== Tokens (aligned with postlogin) ===== */
  :root{
    --bg:#0a0d17; --bg2:#0f1425; --panel:rgba(255,255,255,.06);
    --panelBorder:rgba(255,255,255,.12); --muted:rgba(255,255,255,.72);
    --ink:#fff; --accent:#4f46e5; --navH:72px; --tickerH:40px;
    --green:#22c55e; --red:#ef4444; --gold:#f5c14b;
    --card:#111627;
  }
  *,*:before,*:after{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;color:var(--ink);
    background:linear-gradient(180deg,var(--bg),var(--bg2));
    font-family: ui-sans-serif,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans";
  }
  a{color:inherit;text-decoration:none}
  .wrap{max-width:1200px;margin:0 auto;padding:0 16px}

  /* ===== Nav (mirrors postlogin) ===== */
  header.nav{
    position:sticky;top:0;z-index:30;border-bottom:1px solid rgba(255,255,255,.06);
    background:linear-gradient(180deg,rgba(10,13,23,.95),rgba(10,13,23,.6));
    backdrop-filter:blur(6px) saturate(1.1);
  }
  .nav-inner{display:flex;justify-content:space-between;align-items:center;padding:18px 0;min-height:var(--navH)}
  .nav-left,.nav-right{display:flex;align-items:center;gap:18px}
  .logo-box{width:36px;height:36px;border-radius:10px;background:#fff;color:#000;font-weight:900;display:grid;place-items:center}
  .brand{letter-spacing:.18em;font-size:12px;color:rgba(255,255,255,.6)}
  .nav-link{opacity:.9} .nav-link:hover{opacity:1}
  .coin{width:18px;height:18px;border-radius:9999px;background:radial-gradient(circle at 30% 30%, #fff8, transparent 60%), #eab308;border:1px solid #a16207;display:inline-block}

  /* ===== Ticker ribbon ===== */
  .ticker-wrap{height:var(--tickerH);border-bottom:1px solid rgba(255,255,255,.06);
    background:linear-gradient(180deg,rgba(10,13,23,.6),rgba(10,13,23,.3));overflow:hidden;position:relative}
  .ticker{position:absolute;white-space:nowrap;display:flex;gap:40px;align-items:center;height:100%;padding-left:16px;will-change:transform}
  .tick{display:flex;gap:8px;align-items:center;font-size:14px}
  .up{color:var(--green)} .down{color:var(--red)}
  .dot{width:8px;height:8px;border-radius:9999px;background:#9ca3af;display:inline-block}

  /* ===== Page header ===== */
  h1{margin:18px 0 10px;font-size:20px;letter-spacing:.02em;font-weight:1000}

  /* ===== 3-up hero row ===== */
  .hero-grid{display:grid;grid-template-columns:2fr 1fr 1fr;gap:16px}
  .panel{background:var(--panel);border:1px solid var(--panelBorder);border-radius:18px;padding:16px}
  .panel h3{margin:0 0 12px;font-size:14px;font-weight:900;color:rgba(255,255,255,.8)}
  .muted{color:var(--muted)}

  .chart-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;gap:10px}
  .chart-tabs{display:flex;gap:4px;flex-wrap:wrap}
  .chip{font-size:12px;padding:6px 10px;border-radius:9999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.14);cursor:pointer;user-select:none}
  .chip.active{background:#fff;color:#000;border-color:#fff}
  .stat-row{display:flex;align-items:baseline;gap:10px;margin-top:10px}
  .big-num{font-size:36px;font-weight:1000}
  .delta{font-weight:900} .delta.up{color:var(--green)} .delta.down{color:var(--red)}

  .list{display:grid;gap:12px}
  .row{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;padding:10px 12px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12)}
  .avatar{width:36px;height:36px;border-radius:9999px;background:#0ea5e9;border:1px solid rgba(255,255,255,.25);display:grid;place-items:center;font-weight:900}
  .meta{font-size:12px;color:rgba(255,255,255,.75)}
  .price{font-weight:900}
  .pct{font-size:12px}

  /* ===== Table section ===== */
  .table-panel{margin-top:16px}
  .table-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  .tools{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .search{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:8px 10px}
  .search input{background:transparent;border:0;color:#fff;outline:none;width:220px}
  .sort{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:8px 10px;color:#fff}

  .player-row{display:grid;grid-template-columns:1.2fr .6fr .6fr auto auto;gap:10px;align-items:center;
              padding:12px;border-bottom:1px solid rgba(255,255,255,.08)}
  .pill-btn{background:#000;color:#fff;border:1px solid rgba(255,255,255,.2);border-radius:9999px;padding:6px 14px;font-weight:900;cursor:pointer}
  .pill-btn.secondary{background:rgba(255,255,255,.06)}
  .pager{display:flex;justify-content:flex-end;gap:8px;align-items:center;padding:10px;flex-wrap:wrap}
  .page-btn{width:36px;height:36px;border-radius:9999px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.06);display:grid;place-items:center;cursor:pointer}
  .page-btn.active{background:#fff;color:#000;border-color:#fff}

  /* ===== Particles background ===== */
  #particles{position:fixed;inset:0;z-index:-1;pointer-events:none}

  /* ===== Detail Overlay (Mahomes) ===== */
  .overlay{position:fixed;inset:0;background:rgba(10,13,23,.92);backdrop-filter:blur(6px);z-index:50;display:none;overflow:auto}
  .sheet{max-width:1280px;margin:20px auto;padding:16px}
  .detail-grid{display:grid;grid-template-columns:1.25fr 1.8fr .9fr;gap:16px}
  .card{background:var(--panel);border:1px solid var(--panelBorder);border-radius:18px;padding:16px}
  .back-btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:9999px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.06);cursor:pointer}
  .name{font-size:40px;font-weight:1000;margin:12px 0 6px}
  .team{color:var(--muted);display:flex;align-items:center;gap:8px}

  .pay-receive{display:grid;gap:12px;margin-top:10px}
  .box{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:14px}
  .box .label{font-size:12px;color:var(--muted);letter-spacing:.08em}
  .box .amt{font-size:28px;font-weight:1000;margin-top:6px}
  .chips{display:flex;gap:8px;margin-left:auto}
  .chip-sm{font-size:12px;padding:6px 10px;border-radius:9999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.14);cursor:pointer}
  .primary{display:block;width:100%;margin-top:12px;padding:12px 16px;border-radius:12px;background:#fff;color:#000;font-weight:900;border:0;cursor:pointer}

  .jersey{height:100%;border-radius:18px;background:#caa04d;display:grid;place-items:center;position:relative;overflow:hidden}
  .jersey:after{content:"";position:absolute;inset:0;background:radial-gradient(ellipse at 40% 30%, rgba(255,255,255,.18), transparent 50%);}
  .jersey-inner{width:78%;max-width:720px;aspect-ratio:3/4;background:linear-gradient(180deg,#f0f0f2,#e3e3e6 45%,#f2f2f4);border-radius:8px;box-shadow:0 10px 40px rgba(0,0,0,.45);display:grid;place-items:center}
  .jersey-num{font-size:140px;font-weight:1000;color:#111;letter-spacing:.03em;text-shadow:0 2px 0 #bbb}
  .pos-badge{position:absolute;top:14px;right:14px;background:rgba(255,255,255,.85);color:#111;border-radius:9999px;padding:8px 14px;font-weight:900}

  .info-col .info-card{margin-bottom:16px}
  .info-title{font-size:12px;color:var(--muted);margin-bottom:8px}
  .info-value{font-size:28px;font-weight:1000}

  .matches{display:flex;gap:12px;overflow:auto;padding-bottom:6px}
  .match-card{min-width:260px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:12px}
  .match-top{display:flex;justify-content:space-between;color:var(--muted);font-size:12px;margin-bottom:10px}
  .match-body{display:grid;grid-template-columns:1fr 24px 1fr;gap:8px;align-items:center}
  .badge{width:42px;height:42px;border-radius:9999px;background:#374151;display:grid;place-items:center;font-weight:900}

  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .mini-title{font-weight:900;margin-bottom:8px}
  .close-x{position:fixed;top:14px;right:14px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.18);width:40px;height:40px;border-radius:9999px;display:grid;place-items:center;cursor:pointer;z-index:60}
  .dim{color:var(--muted)}
  @media(max-width:1200px){ .detail-grid{grid-template-columns:1fr} .jersey{min-height:520px} }
  @media(max-width:1024px){ .hero-grid{grid-template-columns:1fr} }
</style>
</head>
<body>
<canvas id="particles"></canvas>

<!-- NAV -->
<header class="nav">
  <div class="wrap nav-inner">
    <div class="nav-left">
      <div class="logo-box">A</div>
      <div class="brand nav-link" href="postlogin.html">AMERICAN FOOTBALL FUN</div>
      <a class="nav-link" href="squad.html">Squad</a>
      <a class="nav-link" href="transfers.html">Transfers</a>
      <a class="nav-link" href="#">Live Scores</a>
      <a class="nav-link" href="#">Leaderboard</a>
    </div>
    <div class="nav-right">
      <span title="Notifications">üõéÔ∏è</span>
      <span style="display:inline-flex;align-items:center;gap:8px" class="pill">
        <span class="coin"></span> 0
      </span>
      <span class="avatar" style="width:32px;height:32px;background:#111">V</span>
    </div>
  </div>
</header>

<!-- TICKER -->
<div class="ticker-wrap">
  <div class="ticker" id="ticker"></div>
</div>

<main class="wrap">
  <h1>Transfers</h1>

  <!-- HERO GRID -->
  <section class="hero-grid">
    <!-- Card 1: Toggleable Chart -->
    <div class="panel">
      <div class="chart-head">
        <h3><span id="chartTitle">Total Market Cap</span></h3>
        <div>
          <div class="chart-tabs" id="rangeTabs">
            <span class="chip" data-range="D">D</span>
            <span class="chip" data-range="W">W</span>
            <span class="chip" data-range="M">M</span>
            <span class="chip" data-range="Y">Y</span>
          </div>
          <div class="chart-tabs" style="margin-top:6px">
            <span class="chip active" id="capTab">Market Cap</span>
            <span class="chip" id="volTab">Volume</span>
          </div>
        </div>
      </div>
      <canvas id="mainChart" height="120"></canvas>
      <div class="stat-row">
        <div class="big-num" id="bigStat">30.04m</div>
        <div class="delta up" id="bigDelta">‚Üë 1.3%</div>
      </div>
    </div>

    <!-- Card 2: Trending -->
    <div class="panel">
      <h3>Trending</h3>
      <div class="list" id="trending"></div>
    </div>

    <!-- Card 3: Top Gainers -->
    <div class="panel">
      <h3>Top Gainers</h3>
      <div class="list" id="gainers"></div>
    </div>
  </section>

  <!-- TABLE SECTION -->
  <section class="panel table-panel">
    <div class="table-head">
      <div style="font-weight:900">Players</div>
      <div class="tools">
        <div class="search">üîé <input id="searchBox" placeholder="Search" /></div>
        <select id="sortSelect" class="sort">
          <option value="name">Sort by: Name</option>
          <option value="price">Sort by: Price</option>
          <option value="delta">Sort by: 1h Change</option>
        </select>
      </div>
    </div>
    <div id="tableBody"></div>
    <div class="pager" id="pager"></div>
  </section>

  <div style="height:24px"></div>
</main>

<!-- ================= Mahomes Detail Overlay ================= -->
<div class="overlay" id="detail">
  <div class="close-x" id="closeX">‚úï</div>
  <div class="sheet">
    <!-- Back / Title -->
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <button class="back-btn" id="backBtn">‚Üê Back to Transfers</button>
      <div class="dim">Demo detail: Patrick Mahomes</div>
    </div>

    <!-- Top grid -->
    <section class="detail-grid">
      <!-- LEFT: Pay / Receive -->
      <div class="card">
        <div class="team">Kansas City Chiefs ‚Ä¢ QB</div>
        <div class="name">Patrick Mahomes</div>
        <div class="chips" style="margin:8px 0 0 0">
          <span class="chip-sm" data-fill="25">25%</span>
          <span class="chip-sm" data-fill="50">50%</span>
          <span class="chip-sm" data-fill="100">MAX</span>
        </div>

        <div class="pay-receive">
          <div class="box">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="label">YOU PAY</div>
              <div class="label">ü™ô GOLD</div>
            </div>
            <div class="amt" id="payAmt">0</div>
            <div class="label" style="margin-top:4px">YOUR BALANCE <span id="bal" class="dim">0 GOLD</span></div>
          </div>
          <div style="display:grid;place-items:center;opacity:.7">‚áÖ</div>
          <div class="box">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="label">YOU RECEIVE</div>
              <div class="label">üèà MAHOMES</div>
            </div>
            <div class="amt" id="recvAmt">0</div>
            <div class="label" style="margin-top:4px">YOUR SHARES <span id="shares" class="dim">0 MAH</span></div>
          </div>
          <button class="primary" id="buyNow">Buy Now</button>
        </div>
      </div>

      <!-- MIDDLE: Jersey -->
      <div class="jersey card" style="padding:0">
        <div class="pos-badge">QB</div>
        <div class="jersey-inner">
          <div class="jersey-num">15</div>
        </div>
      </div>

      <!-- RIGHT: Info boxes -->
      <div class="info-col">
        <div class="card info-card">
          <div class="info-title">Age</div>
          <div class="info-value">28</div>
        </div>
        <div class="card info-card">
          <div class="info-title">Nationality</div>
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:24px">üá∫üá∏</span>
            <div class="info-value" style="font-size:24px">USA</div>
          </div>
        </div>
        <div class="card info-card">
          <div class="info-title">Active / Circ. Supply</div>
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:26px">üë•</span>
            <div class="info-value" style="font-size:26px">540.2k <span class="dim" style="font-size:18px">/ 1.7m</span></div>
          </div>
        </div>
        <div class="card info-card">
          <div class="info-title">Your Shares</div>
          <div class="info-value" id="yourShares">0</div>
        </div>
      </div>
    </section>

    <!-- Div 2: Upcoming Matches -->
    <section class="card" style="margin-top:16px">
      <div class="mini-title">Upcoming Matches</div>
      <div class="matches" id="matches"></div>
    </section>

    <!-- Div 3: Performance + Tournament History -->
    <section class="grid-2" style="margin-top:16px">
      <div class="card">
        <div class="mini-title">Performance</div>
        <canvas id="perfChart" height="120"></canvas>
      </div>
      <div class="card">
        <div class="mini-title">Tournament History</div>
        <canvas id="histChart" height="120"></canvas>
      </div>
    </section>

    <!-- Div 4: Price over time + Player Stats -->
    <section class="grid-2" style="margin-top:16px">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="mini-title">Price Over Time</div>
          <div class="chart-tabs" id="ptTabs">
            <span class="chip" data-pr="D">D</span>
            <span class="chip" data-pr="W">W</span>
            <span class="chip" data-pr="M">M</span>
            <span class="chip" data-pr="Y">Y</span>
          </div>
        </div>
        <canvas id="priceChart" height="120"></canvas>
        <div style="margin-top:6px;color:var(--green);font-weight:900">‚Üë 1.89</div>
      </div>

      <!-- REPLACED: new polar radar-like chart -->
      <div class="card">
        <div class="mini-title">Player Stats</div>
        <canvas id="statsChart" height="140"></canvas>
      </div>
    </section>

    <div style="height:24px"></div>
  </div>
</div>
<!-- ========================================================= -->

<script>
  /* ===========================
     TICKER
     =========================== */
  const tickerEl = document.getElementById('ticker');
  const tickerData = [
    {n:"P. Mahomes", d:+0.9},{n:"J. Jefferson", d:+0.8},{n:"C. McCaffrey", d:+0.7},
    {n:"J. Allen", d:+0.6},{n:"J. Hurts", d:+0.5},{n:"T. Hill", d:+0.9},
    {n:"M. Parsons", d:-0.3},{n:"N. Bosa", d:+0.4},{n:"J. Chase", d:+0.6},
    {n:"A. Rodgers", d:-0.2},{n:"D. Henry", d:+0.3},{n:"S. Diggs", d:-0.1},
    {n:"C. Kelce", d:+0.5},{n:"C. Lamb", d:+0.8},{n:"G. Kittle", d:-0.3}
  ];
  function buildTicker(){
    function node(item){
      const wrap=document.createElement('div'); wrap.className='tick';
      const dot=document.createElement('span'); dot.className='dot';
      const name=document.createElement('span'); name.textContent=item.n;
      const pct=document.createElement('span'); pct.className=item.d>=0?'up':'down';
      pct.textContent=`${item.d>=0?'+':''}${item.d.toFixed(1)}%`;
      wrap.append(dot,name,pct); return wrap;
    }
    [...tickerData, ...tickerData].forEach(it=>tickerEl.appendChild(node(it)));
    let w=tickerEl.scrollWidth/2, x=0;
    (function step(){ x -= 0.5; if(Math.abs(x) >= w) x = 0; tickerEl.style.transform=`translateX(${x}px)`; requestAnimationFrame(step); })();
  }
  buildTicker();

  /* ===========================
     CHART: Market Cap vs Volume + D/W/M/Y
     =========================== */
  const ctx = document.getElementById('mainChart').getContext('2d');
  const axis = {
    ticks:{ color:'rgba(255,255,255,.8)' },
    grid:{ display:true, drawBorder:false, color:'rgba(255,255,255,.15)' }
  };

  // Labels for ranges
  const labels = {
    D: Array.from({length:24},(_,i)=>`${String(i).padStart(2,'0')}:00`),
    W: ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
    M: Array.from({length:30},(_,i)=>`${i+1}`),
    Y: ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
  };

  // Calm daily market cap; others mildly wavy
  const cap = {
    D: [29.6,29.7,29.8,29.85,29.9,29.95,30.0,30.02,30.05,30.1,30.08,30.1,30.12,30.15,30.14,30.18,30.2,30.22,30.21,30.23,30.25,30.26,30.28,30.3],
    W: [28.9,29.4,29.8,29.6,30.0,30.1,30.04],
    M: [27.8,28.1,28.6,28.4,28.9,29.2,29.0,29.4,29.6,29.3,29.8,30.0,29.9,30.2,30.1,30.3,30.0,30.4,30.2,30.5,30.4,30.6,30.3,30.7,30.6,30.8,30.7,30.9,30.8,31.0],
    Y: [18.2,19.1,20.3,21.7,22.9,24.0,24.8,25.6,26.9,28.3,29.1,30.0]
  };
  const vol = {
    D: [2.1,2.2,1.8,2.0,2.4,3.2,2.7,3.0,2.6,2.1,2.3,2.0,1.9,2.4,2.2,1.6,2.8,2.5,2.2,2.7,2.1,2.0,1.6,1.5],
    W: [72,81,69,88,63,76,54],
    M: [61,70,64,73,58,92,84,71,66,59,80,77,69,65,83,91,74,62,58,71,67,53,49,60,72,65,69,58,63,61],
    Y: [1200,1320,1100,1600,1400,1700,1500,1800,1300,1450,1380,1500]
  };

  const chartTitle = document.getElementById('chartTitle');
  const bigStat = document.getElementById('bigStat');
  const bigDelta = document.getElementById('bigDelta');
  const capTab = document.getElementById('capTab');
  const volTab = document.getElementById('volTab');

  let mode = 'cap'; // 'cap' | 'vol'
  let range = 'D';  // 'D' | 'W' | 'M' | 'Y'

  function headline(){
    if(mode==='cap'){
      const last = cap[range][cap[range].length-1];
      const prev = cap[range][0];
      const pct = ((last - prev)/Math.max(prev,1))*100;
      bigStat.textContent = `${last.toFixed(range==='Y'?1:2)}m`;
      bigDelta.className = `delta ${pct>=0?'up':'down'}`;
      bigDelta.textContent = `${pct>=0?'‚Üë':'‚Üì'} ${Math.abs(pct).toFixed(1)}%`;
      chartTitle.textContent = 'Total Market Cap';
    }else{
      const last = vol[range][vol[range].length-1];
      const prev = vol[range][0];
      const pct = ((last - prev)/Math.max(prev,1))*100;
      bigStat.textContent = range==='Y' ? `${last.toFixed(0)}k` : `${last.toFixed(2)}k`;
      bigDelta.className = `delta ${pct>=0?'up':'down'}`;
      bigDelta.textContent = `${pct>=0?'‚Üë':'‚Üì'} ${Math.abs(pct).toFixed(1)}%`;
      chartTitle.textContent = 'Total Volume';
    }
  }
  function colors(){
    return mode==='cap'
      ? { stroke:'#22c55e', fill:'rgba(34,197,94,.25)' }
      : { stroke:'#60a5fa', fill:'rgba(96,165,250,.25)' };
  }
  function dataset(){ return mode==='cap' ? cap[range] : vol[range]; }

  let chart = new Chart(ctx,{
    type:'line',
    data:{ labels: labels[range], datasets:[{
      label: 'Total Market Cap',
      data: dataset(),
      borderColor: colors().stroke,
      backgroundColor: colors().fill,
      fill:true, tension:.35, pointRadius:0, borderWidth:3
    }]},
    options:{ responsive:true, plugins:{ legend:{ display:false } }, scales:{ x:axis, y:axis } }
  });

  function refreshChart(){
    chart.data.labels = labels[range];
    chart.data.datasets[0].data = dataset();
    chart.data.datasets[0].label = mode==='cap' ? 'Total Market Cap' : 'Total Volume';
    chart.data.datasets[0].borderColor = colors().stroke;
    chart.data.datasets[0].backgroundColor = colors().fill;
    chart.update();
    headline();
  }

  function activateTab(which){
    capTab.classList.toggle('active', which==='cap');
    volTab.classList.toggle('active', which==='vol');
  }
  capTab.addEventListener('click', ()=>{ mode='cap'; activateTab('cap'); refreshChart(); });
  volTab.addEventListener('click', ()=>{ mode='vol'; activateTab('vol'); refreshChart(); });
  document.querySelectorAll('[data-range]').forEach(el=>{
    el.addEventListener('click', ()=>{
      document.querySelectorAll('[data-range]').forEach(b=>b.classList.remove('active'));
      el.classList.add('active');
      range = el.getAttribute('data-range');
      refreshChart();
    });
  });
  document.querySelector('[data-range="D"]').classList.add('active');
  activateTab('cap');
  refreshChart();

  /* ===========================
     Trending & Gainers
     =========================== */
  const trendingArr = [
    {name:'Patrick Mahomes', tag:'KC ‚Ä¢ QB', price:0.0245, delta:+0.0},
    {name:'Justin Jefferson', tag:'MIN ‚Ä¢ WR', price:0.0494, delta:+0.0},
    {name:'Tyreek Hill', tag:'MIA ‚Ä¢ WR', price:0.0434, delta:+0.0},
  ];
  const gainersArr = [
    {name:'Talanoa Hufanga', tag:'SF ‚Ä¢ DB', price:0.117, delta:+1.0},
    {name:'CeeDee Lamb', tag:'DAL ‚Ä¢ WR', price:0.0482, delta:+1.0},
    {name:'Ja\'Marr Chase', tag:'CIN ‚Ä¢ WR', price:0.111, delta:+1.0},
  ];
  function fillList(id, arr){
    const box = document.getElementById(id);
    box.innerHTML='';
    arr.forEach((p,i)=>{
      const row=document.createElement('div'); row.className='row';
      const av=document.createElement('div'); av.className='avatar'; av.textContent=String(i+1).padStart(2,'0');
      const mid=document.createElement('div'); mid.innerHTML=`<div style="font-weight:900">${p.name}</div><div class="meta">${p.tag}</div>`;
      const r=document.createElement('div'); r.style.textAlign='right';
      r.innerHTML=`<div class="price">ü™ô ${p.price.toFixed(4)}</div><div class="pct up">+${p.delta.toFixed(0)}%</div>`;
      row.append(av,mid,r); box.appendChild(row);
    });
  }
  fillList('trending', trendingArr);
  fillList('gainers', gainersArr);

  /* ===========================
     Players table (100 items)
     =========================== */
  const NAMES = [
    "Patrick Mahomes","Josh Allen","Jalen Hurts","Joe Burrow","Justin Herbert","Lamar Jackson","C.J. Stroud","Tua Tagovailoa","Dak Prescott","Kirk Cousins",
    "Christian McCaffrey","Derrick Henry","Saquon Barkley","Bijan Robinson","Breece Hall","Jonathan Taylor","Nick Chubb","Alvin Kamara","Josh Jacobs","Austin Ekeler",
    "Justin Jefferson","Ja'Marr Chase","Tyreek Hill","CeeDee Lamb","Amon-Ra St. Brown","Stefon Diggs","A.J. Brown","Garrett Wilson","Jaylen Waddle","DeVonta Smith",
    "Travis Kelce","George Kittle","Mark Andrews","Sam LaPorta","T.J. Hockenson","David Njoku","Evan Engram","Kyle Pitts","Pat Freiermuth","Dalton Kincaid",
    "Micah Parsons","T.J. Watt","Nick Bosa","Myles Garrett","Maxx Crosby","Aidan Hutchinson","Sauce Gardner","Jaire Alexander","Patrick Surtain II","Derwin James",
    "Cooper Kupp","Mike Evans","Chris Olave","Deebo Samuel","DJ Moore","Tee Higgins","Drake London","DeAndre Hopkins","Brandon Aiyuk","Amari Cooper",
    "Tony Pollard","Rhamondre Stevenson","Aaron Jones","Joe Mixon","Kenneth Walker III","Javonte Williams","Raheem Mostert","Isiah Pacheco","James Cook","Najee Harris",
    "Geno Smith","Brock Purdy","Jordan Love","Trevor Lawrence","Deshaun Watson","Baker Mayfield","Anthony Richardson","Justin Fields","Kyler Murray","Matthew Stafford",
    "Jake Elliott","Justin Tucker","Harrison Butker","Evan McPherson","Younghoe Koo","Tyler Bass","Jason Myers","Daniel Carlson","Greg Zuerlein","Brandon Aubrey",
    "Chris Jones","Quinnen Williams","Aaron Donald","Fred Warner","Roquan Smith","Bobby Wagner","Maxx Crosby Jr.","Kayvon Thibodeaux","Brian Burns","Haason Reddick"
  ];
  function pickTeam(i){
    const teams = ["KC","BUF","PHI","CIN","LAC","BAL","HOU","MIA","DAL","MIN","SF","LV","NYJ","ATL","DET","IND","CLE","NO","GB","LAR","SEA","JAX","TB","TEN","CHI","ARI","NE","CAR","WAS","PIT"];
    return teams[i % teams.length];
  }
  function posForName(n){
    if(["Mahomes","Allen","Hurts","Burrow","Herbert","Jackson","Stroud","Tagovailoa","Prescott","Cousins","Smith","Purdy","Love","Lawrence","Watson","Mayfield","Richardson","Fields","Murray","Stafford"].some(k=>n.includes(k))) return "QB";
    if(["Kelce","Kittle","Andrews","LaPorta","Hockenson","Njoku","Engram","Pitts","Freiermuth","Kincaid"].some(k=>n.includes(k))) return "TE";
    if(["McCaffrey","Henry","Barkley","Bijan","Hall","Taylor","Chubb","Kamara","Jacobs","Ekeler","Pollard","Stevenson","Jones","Mixon","Walker","Williams","Mostert","Pacheco","Cook","Harris"].some(k=>n.includes(k))) return "RB";
    if(["Jefferson","Chase","Hill","Lamb","Brown","Diggs","Waddle","Smith","Kupp","Evans","Olave","Samuel","Moore","Higgins","London","Hopkins","Aiyuk","Cooper","St. Brown","Wilson"].some(k=>n.includes(k))) return "WR";
    if(["Tucker","Butker","Elliott","McPherson","Koo","Bass","Myers","Carlson","Zuerlein","Aubrey"].some(k=>n.includes(k))) return "K";
    return "DEF";
  }
  const players = NAMES.map((name,i)=>({
    name,
    tag: `${pickTeam(i)} ‚Ä¢ ${posForName(name)}`,
    price: Number((Math.random()*1.9+0.1).toFixed(3)),
    delta: Number((Math.random()*0.8-0.4).toFixed(1))
  }));

  const PAGE_SIZE = 20;
  let page = 1;
  let filtered = players.slice();
  const tableBody = document.getElementById('tableBody');
  const pager = document.getElementById('pager');
  const searchBox = document.getElementById('searchBox');
  const sortSelect = document.getElementById('sortSelect');

  function renderTable(){
    tableBody.innerHTML = '';
    const start = (page-1)*PAGE_SIZE;
    const slice = filtered.slice(start, start+PAGE_SIZE);
    slice.forEach(p=>{
      const row = document.createElement('div'); row.className='player-row'; row.dataset.name = p.name;
      row.innerHTML = `
        <div style="display:flex;align-items:center;gap:10px">
          <div class="avatar">${p.name.split(' ')[0][0]}</div>
          <div>
            <div style="font-weight:900">${p.name}</div>
            <div class="meta">${p.tag}</div>
          </div>
        </div>
        <div class="price">ü™ô ${p.price.toFixed(3)}</div>
        <div class="pct ${p.delta>=0?'up':'down'}">${p.delta>=0?'+':''}${p.delta}%</div>
        <button class="pill-btn buy-btn">Buy</button>
        <button class="pill-btn secondary" disabled>Sell</button>`;
      tableBody.appendChild(row);
    });

    // Bind Buy buttons each render
    document.querySelectorAll('.buy-btn').forEach(btn=>{
      btn.onclick = (e)=>{
        const name = e.target.closest('.player-row').dataset.name;
        if(name === 'Patrick Mahomes'){ openDetail(); }
        else alert('Demo detail is implemented for Patrick Mahomes only during the hackathon demo.');
      };
    });

    renderPager();
  }

  function renderPager(){
    const pages = Math.ceil(filtered.length / PAGE_SIZE);
    pager.innerHTML = '';
    const prev = document.createElement('div'); prev.className='page-btn'; prev.textContent='‚óÄ';
    prev.onclick=()=>{ if(page>1){page--; renderTable();} };
    pager.appendChild(prev);
    for(let i=1;i<=pages;i++){
      const b=document.createElement('div'); b.className='page-btn'+(i===page?' active':''); b.textContent=i;
      b.onclick=()=>{ page=i; renderTable(); };
      pager.appendChild(b);
    }
    const next = document.createElement('div'); next.className='page-btn'; next.textContent='‚ñ∂';
    next.onclick=()=>{ if(page<pages){page++; renderTable();} };
    pager.appendChild(next);
  }

  function applySearch(){
    const q = searchBox.value.trim().toLowerCase();
    filtered = players.filter(p => p.name.toLowerCase().includes(q) || p.tag.toLowerCase().includes(q));
    page = 1; applySort(); renderTable();
  }
  function applySort(){
    const k = sortSelect.value;
    filtered.sort((a,b)=>{
      if(k==='name') return a.name.localeCompare(b.name);
      if(k==='price') return b.price - a.price;
      if(k==='delta') return b.delta - a.delta;
      return 0;
    });
  }
  searchBox.addEventListener('input', applySearch);
  sortSelect.addEventListener('change', ()=>{ applySort(); renderTable(); });

  applySort(); renderTable();

  /* ===========================
     Particles background
     =========================== */
  (function(){
    const c = document.getElementById('particles'), ctx=c.getContext('2d');
    let w,h,ratio=window.devicePixelRatio||1, pts=[], COUNT=120;
    function resize(){ w=c.clientWidth=window.innerWidth; h=c.clientHeight=window.innerHeight; c.width=Math.floor(w*ratio); c.height=Math.floor(h*ratio); ctx.setTransform(ratio,0,0,ratio,0,0); }
    function make(){ pts = Array.from({length: COUNT}, () => ({ x:Math.random()*w, y:Math.random()*h, r:1+Math.random()*2, vx:(-0.25+Math.random()*0.5), vy:(-0.25+Math.random()*0.5), a:0.35+Math.random()*0.3 })); }
    function tick(){ ctx.clearRect(0,0,w,h); for(const p of pts){ p.x+=p.vx; p.y+=p.vy; if(p.x<0||p.x>w) p.vx*=-1; if(p.y<0||p.y>h) p.vy*=-1; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fillStyle=`rgba(255,255,255,${p.a})`; ctx.fill(); } requestAnimationFrame(tick); }
    resize(); make(); tick(); window.addEventListener('resize', ()=>{ resize(); make(); });
  })();

  /* ===========================
     DETAIL OVERLAY LOGIC (Mahomes)
     =========================== */
  const overlay = document.getElementById('detail');
  const backBtn = document.getElementById('backBtn');
  const closeX = document.getElementById('closeX');
  function openDetail(){ overlay.style.display='block'; initDetailCharts(); }
  function closeDetail(){ overlay.style.display='none'; }
  backBtn.onclick = closeDetail;
  closeX.onclick = closeDetail;

  // Demo balances and % chips
  let balance = 100; // GOLD
  let pricePerShare = 1.89; // demo
  document.getElementById('bal').textContent = `${balance.toFixed(0)} GOLD`;
  function setAmounts(pct){
    const pay = balance * pct;
    const receive = pay / pricePerShare;
    document.getElementById('payAmt').textContent = pay.toFixed(0);
    document.getElementById('recvAmt').textContent = receive.toFixed(2);
  }
  document.querySelectorAll('[data-fill]').forEach(ch=>{
    ch.onclick = ()=> setAmounts(parseInt(ch.dataset.fill,10)/100);
  });
  document.getElementById('buyNow').onclick = ()=>{
    const recv = parseFloat(document.getElementById('recvAmt').textContent)||0;
    const pay  = parseFloat(document.getElementById('payAmt').textContent)||0;
    if(pay<=0 || recv<=0) return alert('Choose 25%, 50% or MAX to simulate a buy.');
    balance = Math.max(0, balance - pay);
    document.getElementById('bal').textContent = `${balance.toFixed(0)} GOLD`;
    const cur = parseFloat(document.getElementById('yourShares').textContent)||0;
    document.getElementById('yourShares').textContent = (cur + recv).toFixed(2);
    document.getElementById('shares').textContent = `${(cur + recv).toFixed(2)} MAH`;
    alert('Demo buy complete on Flare-side token (no XRPL movement in this view).');
  };

  // Matches scroller data
  const matches = [
    {d:"Sep 23 ‚Ä¢ 15:30", home:"KC", away:"BUF"},
    {d:"Sep 27 ‚Ä¢ 10:15", home:"KC", away:"BAL"},
    {d:"Sep 30 ‚Ä¢ 12:45", home:"LAC", away:"KC"},
    {d:"Oct 04 ‚Ä¢ 15:00", home:"KC", away:"LV"},
    {d:"Oct 10 ‚Ä¢ 14:45", home:"PHI", away:"KC"},
    {d:"Oct 18 ‚Ä¢ 11:30", home:"KC", away:"MIA"},
    {d:"Oct 25 ‚Ä¢ 09:00", home:"CIN", away:"KC"},
    {d:"Nov 01 ‚Ä¢ 13:00", home:"KC", away:"DEN"},
    {d:"Nov 08 ‚Ä¢ 16:30", home:"SEA", away:"KC"},
    {d:"Nov 15 ‚Ä¢ 18:00", home:"KC", away:"JAX"},
  ];
  const matchWrap = document.getElementById('matches');
  matches.forEach(m=>{
    const card = document.createElement('div'); card.className='match-card';
    card.innerHTML = `
      <div class="match-top"><span>${m.d}</span><span style="width:14px;height:14px;background:#2563eb;border-radius:9999px;display:inline-block"></span></div>
      <div class="match-body">
        <div class="badge">${m.home}</div>
        <div class="dim">vs</div>
        <div class="badge">${m.away}</div>
      </div>`;
    matchWrap.appendChild(card);
  });

  // Detail charts
  let perfChart, histChart, priceChart, statsChart;
  function initDetailCharts(){
    if(perfChart){ return; } // init once

    const axisSmall = {
      ticks:{ color:'rgba(255,255,255,.8)' },
      grid:{ display:true, drawBorder:false, color:'rgba(255,255,255,.15)' }
    };

    // Performance bars
    const pctx = document.getElementById('perfChart').getContext('2d');
    perfChart = new Chart(pctx,{
      type:'bar',
      data:{
        labels:['AUG-1','AUG-2','SEP-1','SEP-2','SEP-3','SEP-4'],
        datasets:[{ data:[221.75,223.75,131.25,134.75,207,234.75], backgroundColor:'rgba(34,197,94,.7)', borderColor:'#22c55e', borderWidth:1 }]
      },
      options:{ plugins:{legend:{display:false}}, scales:{ x:axisSmall, y:axisSmall } }
    });

    // Tournament history bars (thin)
    const hctx = document.getElementById('histChart').getContext('2d');
    histChart = new Chart(hctx,{
      type:'bar',
      data:{
        labels:['20/08','26/08','01/09','07/09','10/09','15/09','19/09'],
        datasets:[{ data:[2,3,18,3,3,2,1], backgroundColor:'#fff', borderRadius:6, barThickness:18 }]
      },
      options:{ plugins:{legend:{display:false}}, scales:{ x:axisSmall, y:axisSmall } }
    });

    // Price over time with D/W/M/Y
    const prctx = document.getElementById('priceChart').getContext('2d');
    const prL = { D:['09:00','11:00','13:00','15:00','17:00'], W:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], M:Array.from({length:30},(_,i)=>`${i+1}`), Y:['Jan','Mar','May','Jul','Sep','Nov'] };
    const prD = {
      D:[1.77,1.77,1.82,1.82,1.89],
      W:[1.75,1.78,1.80,1.81,1.86,1.88,1.89],
      M:Array.from({length:30},(_,i)=> 1.75 + Math.min(i*0.004, 0.15) + (Math.sin(i/3)*0.01)),
      Y:[1.42,1.58,1.66,1.72,1.84,1.89]
    };
    priceChart = new Chart(prctx,{
      type:'line',
      data:{ labels:prL.D, datasets:[{ data:prD.D, borderColor:'#60a5fa', backgroundColor:'rgba(96,165,250,.25)', fill:true, tension:.3, pointRadius:0, borderWidth:3 }] },
      options:{ plugins:{legend:{display:false}}, scales:{ x:axisSmall, y:axisSmall } }
    });
    function setPriceRange(k){
      priceChart.data.labels = prL[k];
      priceChart.data.datasets[0].data = prD[k];
      priceChart.update();
      document.querySelectorAll('[data-pr]').forEach(b=>b.classList.remove('active'));
      document.querySelector(`[data-pr="${k}"]`).classList.add('active');
    }
    document.getElementById('ptTabs').querySelectorAll('[data-pr]').forEach(b=>{
      b.onclick = ()=> setPriceRange(b.getAttribute('data-pr'));
    });
    setPriceRange('D');

    /* ---------- Player Stats (replicating wedge/radar look) ---------- */
    const sctx = document.getElementById('statsChart').getContext('2d');

    // Labels around the circle (outside), values roughly like your screenshot
    const statLabels = ['SHOOTING','APPEARANCE','ASSISTS','ATTACKING','DEFENDING','DUELS','ERRORS','GOALS','MATCH','PASSING'];
    const statValues = [10,12,12,12,7,10,50,50,18,24]; // tuned for visuals

    // Custom plugin to draw outer labels, dashed inner ring, and value badges
    const polarDecor = {
      id:'polar-decor',
      afterDraw(chart,args,pluginOptions){
        const {ctx, chartArea:{left,top,right,bottom}, _metasets} = chart;
        const cx = (left+right)/2, cy = (top+bottom)/2;
        const arcs = _metasets[0].data;
        if(!arcs || !arcs.length) return;
        const maxR = Math.max(...arcs.map(a=>a.outerRadius));

        // dashed inner ring
        ctx.save();
        ctx.setLineDash([6,6]);
        ctx.strokeStyle = 'rgba(255,255,255,.25)';
        ctx.beginPath();
        ctx.arc(cx,cy,maxR*0.55,0,Math.PI*2);
        ctx.stroke();
        ctx.setLineDash([]);
        // center dot
        ctx.fillStyle='rgba(255,255,255,.7)';
        ctx.beginPath(); ctx.arc(cx,cy,3,0,Math.PI*2); ctx.fill();

        // draw category labels & numbers
        ctx.fillStyle = 'rgba(255,255,255,.55)';
        ctx.font = '12px ui-sans-serif, -apple-system, Segoe UI, Roboto, Arial';
        statLabels.forEach((lab,i)=>{
          const a = (arcs[i].startAngle + arcs[i].endAngle)/2;
          const lx = cx + Math.cos(a)*(maxR+26);
          const ly = cy + Math.sin(a)*(maxR+26);
          ctx.textAlign = Math.cos(a)>0.15 ? 'left' : (Math.cos(a)<-0.15 ? 'right' : 'center');
          ctx.textBaseline = Math.sin(a)>0.15 ? 'top' : (Math.sin(a)<-0.15 ? 'bottom' : 'middle');
          ctx.fillText(lab, lx, ly);

          // value near mid radius
          const vx = cx + Math.cos(a)*(maxR*0.62);
          const vy = cy + Math.sin(a)*(maxR*0.62);
          ctx.fillStyle='rgba(255,255,255,.75)';
          ctx.font='11px ui-sans-serif, -apple-system, Segoe UI, Roboto, Arial';
          ctx.fillText(String(statValues[i]), vx, vy);
          ctx.fillStyle='rgba(255,255,255,.55)';
        });
        ctx.restore();
      }
    };

    statsChart = new Chart(sctx,{
      type:'polarArea',
      data:{
        labels: statLabels,
        datasets:[{
          data: statValues,
          backgroundColor: statValues.map(()=> 'rgba(96,165,250,.25)'),
          borderColor: '#60a5fa',
          borderWidth: 2
        }]
      },
      options:{
        animation:false,
        plugins:{ legend:{display:false} },
        scales:{
          r:{
            ticks:{ display:false },
            grid:{ color:'rgba(255,255,255,.2)' },
            angleLines:{ color:'rgba(255,255,255,.15)' },
            pointLabels:{ display:false }
          }
        }
      },
      plugins:[polarDecor]
    });
  }
</script>
</body>
</html>
